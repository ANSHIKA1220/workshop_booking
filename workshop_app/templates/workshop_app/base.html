<!DOCTYPE html>
<html>
{% load static %}
{% load custom_filters %}
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        {% block title %}
            HomePage
        {% endblock %}
    </title>

    <script src="{% static 'workshop_app/js/jquery-3.4.1.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'workshop_app/js/toastr.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    {% block extra-dependencies %}
    {% endblock %}

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'workshop_app/css/toastr.min.css' %}">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'workshop_app/css/base.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'workshop_app/css/font-awesome.css' %}" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">

    {% block extra-custom-scripts %}
    {% endblock %}

    <style>
    .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{position:static;width:auto;height:auto;padding:.5rem 1rem;background:#000;color:#fff;z-index:1100}
    .navbar-toggler{border:0}
    .navbar .nav-link:focus,.navbar .nav-link:hover{opacity:.85}
    .btn{transition:box-shadow .15s ease,transform .05s ease}
    .btn:active{transform:translateY(1px)}
    .nav-link.active{font-weight:600;text-decoration:underline}
    /* Loading overlay */
    #loading-overlay{position:fixed;inset:0;background:rgba(255,255,255,.7);backdrop-filter:saturate(180%) blur(2px);display:none;align-items:center;justify-content:center;z-index:2000}
    .spinner{width:48px;height:48px;border:4px solid #cbd5e1;border-top-color:#0d6efd;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    </style>

</head>

<body>
<div id="loading-overlay" aria-hidden="true"><div class="spinner" aria-label="Loading"></div></div>
<a href="#main" class="skip-link">Skip to content</a>
{% block header %}
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top">
        {% if user.is_authenticated %}
        <a class="navbar-brand text-white" href="{% url 'workshop_app:index' %}">FOSSEE Workshops</a>
        {% else %}
        <a class="navbar-brand text-white" href="{{request.scheme}}://{{request.get_host}}">FOSSEE Workshops</a>
        {% endif %}
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link text-white {% if request.path == '/' %}active{% endif %}" href="/">
                        Home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white {% if request.resolver_match and request.resolver_match.url_name == 'public' %}active{% endif %}" href="{% url 'statistics_app:public' %}">
                        Workshop Statistics
                    </a>
                </li>
            </ul>
            {% if user.is_authenticated %}
            <ul class="navbar-nav mr-auto">
                {% if request.user|has_group:"instructor" %}
                <li class="nav-item">
                    <a class="nav-link text-white {% if request.resolver_match and request.resolver_match.url_name == 'team' %}active{% endif %}" href="{% url 'statistics_app:team' %}">
                        Team Statistics
                    </a>
                </li>
                {% endif %}
                <li class="nav-item">
                    <a class="nav-link text-white {% if request.resolver_match and request.resolver_match.url_name == 'workshop_status_instructor' %}active{% endif %}{% if request.resolver_match and request.resolver_match.url_name == 'workshop_status_coordinator' %}active{% endif %}" href="{% url 'workshop_app:workshop_status_instructor' %}">
                        Workshop Status
                    </a>
                </li>
                {% if not request.user|has_group:"instructor" %}
                    <li class="nav-item">
                        <a class="nav-link text-white {% if request.resolver_match and request.resolver_match.url_name == 'propose_workshop' %}active{% endif %}" href="{% url 'workshop_app:propose_workshop' %}">
                            Propose Workshop
                        </a>
                    </li>
                {% endif %}
                <li class="nav-item">
                    <a class="nav-link text-white {% if request.resolver_match and request.resolver_match.url_name == 'workshop_type_list' %}active{% endif %}{% if request.resolver_match and request.resolver_match.url_name == 'workshop_type_details' %}active{% endif %}" href="{% url 'workshop_app:workshop_type_list' %}">
                        Workshop Types
                    </a>
                </li>
            </ul>
            <div class="my-2 my-lg-0 ml-auto">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" id="navbarDropdown" role="button"
                           data-bs-toggle="dropdown" aria-expanded="false">
                           <span class="material-icons" style="vertical-align: middle">account_circle</span>
                            <p style="display: inline; vertical-align: middle">
                                {{user.get_full_name|title}}
                            </p>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="{% url 'workshop_app:view_own_profile' %}">Profile</a>
                            <a class="dropdown-item" href="{% url 'password_change' %}">
                                 Change Password
                            </a>
                            <a class="dropdown-item" href="{% url 'workshop_app:logout' %}">Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
            {% endif %}
        </div>
    </nav>
{% endblock %}

<div class="base-content" id="main" tabindex="-1">
    {% block hero %}{% endblock %}
    {% block content %}
        <h1>Base Template Content. Please override me</h1>
    {% endblock %}
</div>

<div id="toastr-messages" style="display:none;">
    {% if messages %}
        {% for message in messages %}
            <span data-level="{{ message.tags|default:'info' }}" data-message="{{ message|escape }}"></span>
        {% endfor %}
    {% endif %}
</div>
<script>
(function(){
  var nodes = document.querySelectorAll('#toastr-messages [data-message]');
  for (var i = 0; i < nodes.length; i++) {
    var n = nodes[i];
    var lvl = n.getAttribute('data-level') || 'info';
    var msg = n.getAttribute('data-message');
    if (window.toastr && toastr[lvl]) { toastr[lvl](msg); }
    else if (window.toastr) { toastr.info(msg); }
  }
  // Global loading indicator
  var overlay = document.getElementById('loading-overlay');
  function show(){ if(overlay){ overlay.style.display='flex'; } }
  function hide(){ if(overlay){ overlay.style.display='none'; } }
  var forms = document.querySelectorAll('form');
  for (var j=0;j<forms.length;j++){ forms[j].addEventListener('submit', function(){ show(); }); }
  window.addEventListener('pageshow', function(){ hide(); });
})();
</script>

</body>
<footer class="footer">
    {% block footer %}
       <div class="container">
           Developed by FOSSEE group, IIT Bombay
       </div> 
    {% endblock %}
</footer>
</html>
